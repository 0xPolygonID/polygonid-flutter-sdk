import 'package:json_annotation/json_annotation.dart';
import 'package:privadoid_sdk/model/jwz/jwz_proof.dart';
import 'package:privadoid_sdk/utils/Base64Encoder.dart';

part 'jwz_payload.g.dart';

/// Sample
/// ```
///       {
///         "id": 1,
///         "circuit_id": "credentialAtomicQueryMTP",
///         "proof": {
///           "pi_a": [
///             "20973485107186613835294420504168844900060429745180277370078136645423323796988",
///             "20876512355517454358387352357430469269532511208427702435640954212414846794988",
///             "1"
///           ],
///           "pi_b": [
///             [
///               "15359787792291301524429511563163819833209670586891499149880103897821631812320",
///               "952148097741318750401406678248864482408113418728045541853254838790211944557"
///             ],
///             [
///               "3866547068988378419787216494850441937393748849859411619995030091666678234233",
///               "12737260954983772047680437941193675886215315463965099527215354428856166589220"
///             ],
///             [
///               "1",
///               "0"
///             ]
///           ],
///           "pi_c": [
///             "14032051669376519932957072147382739134658885782661390170658631107795386034990",
///             "3426651920168576141328466441385872894824417141788260830832563707950605034542",
///             "1"
///           ],
///           "protocol": "groth16"
///         },
///         "pub_signals": ["227999792560601581143923121210388382198276828932112237742319153709274234880","10099789665300975457802178862296098271243359660315802759495016285352640212814","12345","8390795654739203972616926774091445498451520813142121365678565136228528725312","206811791431269707427589302274952473147879888022142096363950465656014110720","1653057062","106590880073303418818490710639556704462","2","4","840","120","340","509","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
///       }
/// ```
@JsonSerializable()
class JWZScope {
  int id;

  @JsonKey(name: 'circuit_id')
  String circuitId;

  JWZBaseProof proof;

  @JsonKey(name: 'pub_signals')
  List<String> pubSignals;

  JWZScope(
      {required this.id,
      required this.circuitId,
      required this.proof,
      required this.pubSignals});

  factory JWZScope.fromJson(Map<String, dynamic> json) =>
      _$JWZScopeFromJson(json);

  Map<String, dynamic> toJson() => _$JWZScopeToJson(this);
}

/// Sample
/// ```
///   {
///     "message": "message to sign",
///     "scope": [
///       {
///         "id": 1,
///         "circuit_id": "credentialAtomicQueryMTP",
///         "proof": {
///           "pi_a": [
///             "20973485107186613835294420504168844900060429745180277370078136645423323796988",
///             "20876512355517454358387352357430469269532511208427702435640954212414846794988",
///             "1"
///           ],
///           "pi_b": [
///             [
///               "15359787792291301524429511563163819833209670586891499149880103897821631812320",
///               "952148097741318750401406678248864482408113418728045541853254838790211944557"
///             ],
///             [
///               "3866547068988378419787216494850441937393748849859411619995030091666678234233",
///               "12737260954983772047680437941193675886215315463965099527215354428856166589220"
///             ],
///             [
///               "1",
///               "0"
///             ]
///           ],
///           "pi_c": [
///             "14032051669376519932957072147382739134658885782661390170658631107795386034990",
///             "3426651920168576141328466441385872894824417141788260830832563707950605034542",
///             "1"
///           ],
///           "protocol": "groth16"
///         },
///         "pub_signals": ["227999792560601581143923121210388382198276828932112237742319153709274234880","10099789665300975457802178862296098271243359660315802759495016285352640212814","12345","8390795654739203972616926774091445498451520813142121365678565136228528725312","206811791431269707427589302274952473147879888022142096363950465656014110720","1653057062","106590880073303418818490710639556704462","2","4","840","120","340","509","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
///       }
///     ]
///   }
/// ```
@JsonSerializable()
class JWZBody {
  String message;
  List<JWZScope> scope;

  JWZBody({required this.message, required this.scope});

  factory JWZBody.fromJson(Map<String, dynamic> json) =>
      _$JWZBodyFromJson(json);

  Map<String, dynamic> toJson() => _$JWZBodyToJson(this);
}

/// Sample
/// ```
/// {
///   "id": "28494007-9c49-4f1a-9694-7700c08865bf",
///   "typ": "application/iden3comm-plain-json",
///   "type": "https://iden3-communication.io/authorization/1.0/response",
///   "thid": "7f38a193-0918-4a48-9fac-36adfdb8b542",
///   "body": {
///     "message": "message to sign",
///     "scope": [
///       {
///         "id": 1,
///         "circuit_id": "credentialAtomicQueryMTP",
///         "proof": {
///           "pi_a": [
///             "20973485107186613835294420504168844900060429745180277370078136645423323796988",
///             "20876512355517454358387352357430469269532511208427702435640954212414846794988",
///             "1"
///           ],
///           "pi_b": [
///             [
///               "15359787792291301524429511563163819833209670586891499149880103897821631812320",
///               "952148097741318750401406678248864482408113418728045541853254838790211944557"
///             ],
///             [
///               "3866547068988378419787216494850441937393748849859411619995030091666678234233",
///               "12737260954983772047680437941193675886215315463965099527215354428856166589220"
///             ],
///             [
///               "1",
///               "0"
///             ]
///           ],
///           "pi_c": [
///             "14032051669376519932957072147382739134658885782661390170658631107795386034990",
///             "3426651920168576141328466441385872894824417141788260830832563707950605034542",
///             "1"
///           ],
///           "protocol": "groth16"
///         },
///         "pub_signals": ["227999792560601581143923121210388382198276828932112237742319153709274234880","10099789665300975457802178862296098271243359660315802759495016285352640212814","12345","8390795654739203972616926774091445498451520813142121365678565136228528725312","206811791431269707427589302274952473147879888022142096363950465656014110720","1653057062","106590880073303418818490710639556704462","2","4","840","120","340","509","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
///       }
///     ]
///   },
///   "from": "119tqceWdRd2F6WnAyVuFQRFjK3WUXq2LorSPyG9LJ",
///   "to": "1125GJqgw6YEsKFwj63GY87MMxPL9kwDKxPUiwMLNZ"
/// }
/// ```
@JsonSerializable()
class JWZPayload with Base64Encoder {
  String id;
  String typ;
  String type;
  String thid;
  JWZBody body;
  String from;
  String to;

  JWZPayload(
      {required this.id,
      required this.typ,
      required this.type,
      required this.thid,
      required this.body,
      required this.from,
      required this.to});

  factory JWZPayload.fromJson(Map<String, dynamic> json) =>
      _$JWZPayloadFromJson(json);

  Map<String, dynamic> toJson() => _$JWZPayloadToJson(this);
}
