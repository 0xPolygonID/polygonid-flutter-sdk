import 'dart:typed_data';

import 'package:flutter_test/flutter_test.dart';
import 'package:polygonid_flutter_sdk/data/identity/jwz/jwz.dart';
import 'package:polygonid_flutter_sdk/data/identity/jwz/jwz_header.dart';
import 'package:polygonid_flutter_sdk/data/identity/jwz/jwz_proof.dart';
import 'package:polygonid_flutter_sdk/libs/circomlib.dart';
import 'package:polygonid_flutter_sdk/utils/uint8_list_utils.dart';

class JWZMocks {
  /// Header
/*
  {
    "alg":"groth16",
    "circuitId":"auth",
    "crit":["circuitId"],
    "typ":"application/iden3-zkp-json"
  }
*/

  /// Payload
/*
      {
        "id": "28494007-9c49-4f1a-9694-7700c08865bf",
        "typ": "application/iden3comm-plain-json",
         "type": "https://iden3-communication.io/authorization/1.0/response",
        "thid": "7f38a193-0918-4a48-9fac-36adfdb8b542",
        "body": {
          "message": "message to sign",
          "scope": [
            {
              "id": 1,
              "circuit_id": "credentialAtomicQueryMTP",
              "proof": {
                "pi_a": [
                  "20973485107186613835294420504168844900060429745180277370078136645423323796988",
                  "20876512355517454358387352357430469269532511208427702435640954212414846794988",
                  "1"
                ],
                "pi_b": [
                  [
                    "15359787792291301524429511563163819833209670586891499149880103897821631812320",
                    "952148097741318750401406678248864482408113418728045541853254838790211944557"
                  ],
                  [
                    "3866547068988378419787216494850441937393748849859411619995030091666678234233",
                    "12737260954983772047680437941193675886215315463965099527215354428856166589220"
                  ],
                  [
                    "1",
                    "0"
                  ]
                ],
                "pi_c": [
                  "14032051669376519932957072147382739134658885782661390170658631107795386034990",
                  "3426651920168576141328466441385872894824417141788260830832563707950605034542",
                  "1"
                ],
                "protocol": "groth16"
              },
              "pub_signals": ["227999792560601581143923121210388382198276828932112237742319153709274234880","10099789665300975457802178862296098271243359660315802759495016285352640212814","12345","8390795654739203972616926774091445498451520813142121365678565136228528725312","206811791431269707427589302274952473147879888022142096363950465656014110720","1653057062","106590880073303418818490710639556704462","2","4","840","120","340","509","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
            }
          ]
        },
        "from": "119tqceWdRd2F6WnAyVuFQRFjK3WUXq2LorSPyG9LJ",
        "to": "1125GJqgw6YEsKFwj63GY87MMxPL9kwDKxPUiwMLNZ"
      }
*/

  /// Proof
/*
      {
          "proof": {
              "pi_a": [
                  "10412436197494479587396667385707368282568055118269864457927476990636419702451",
                  "10781739095445201996467414817941805879982410676386176845296376344985187663334",
                  "1"
              ],
              "pi_b": [
                  [
                      "18067868740006225615447194471370658980999926369695293115712951366707744064606",
                      "21599241570547731234304039989166406415899717659171760043899509152011479663757"
                  ],
                  [
                      "6699540705074924997967275186324755442260607671536434403065529164769702477398",
                      "11257643293201627450293185164288482420559806649937371568160742601386671659800"
                  ],
                  [
                      "1",
                      "0"
                  ]
              ],
              "pi_c": [
                  "6216423503289496292944052032190353625422411483383378979029667243785319208095",
                  "14816218045158388758567608605576384994339714390370300963580658386534158603711",
                  "1"
              ],
              "protocol": "groth16"
          },
          "pub_signals": [
              "4976943943966365062123221999838013171228156495366270377261380449787871898672",
              "18656147546666944484453899241916469544090258810192803949522794490493271005313",
              "379949150130214723420589610911161895495647789006649785264738141299135414272"
          ]
      }
*/

  static String payloadData =
      '{"id":"28494007-9c49-4f1a-9694-7700c08865bf","typ":"application/iden3comm-plain-json","type":"https://iden3-communication.io/authorization/1.0/response","thid":"7f38a193-0918-4a48-9fac-36adfdb8b542","body":{"message":"message to sign","scope":[{"id":1,"circuit_id":"credentialAtomicQueryMTP","proof":{"pi_a":["20973485107186613835294420504168844900060429745180277370078136645423323796988","20876512355517454358387352357430469269532511208427702435640954212414846794988","1"],"pi_b":[["15359787792291301524429511563163819833209670586891499149880103897821631812320","952148097741318750401406678248864482408113418728045541853254838790211944557"],["3866547068988378419787216494850441937393748849859411619995030091666678234233","12737260954983772047680437941193675886215315463965099527215354428856166589220"],["1","0"]],"pi_c":["14032051669376519932957072147382739134658885782661390170658631107795386034990","3426651920168576141328466441385872894824417141788260830832563707950605034542","1"],"protocol":"groth16"},"pub_signals":["227999792560601581143923121210388382198276828932112237742319153709274234880","10099789665300975457802178862296098271243359660315802759495016285352640212814","12345","8390795654739203972616926774091445498451520813142121365678565136228528725312","206811791431269707427589302274952473147879888022142096363950465656014110720","1653057062","106590880073303418818490710639556704462","2","4","840","120","340","509","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]}]},"from":"119tqceWdRd2F6WnAyVuFQRFjK3WUXq2LorSPyG9LJ","to":"1125GJqgw6YEsKFwj63GY87MMxPL9kwDKxPUiwMLNZ"}';

  static JWZPayload jwzPayload = JWZPayload(payload: payloadData);

  /// Base64 are matching the above json
  static String headerBase64 =
      'eyJhbGciOiJncm90aDE2IiwiY2lyY3VpdElkIjoiYXV0aCIsImNyaXQiOlsiY2lyY3VpdElkIl0sInR5cCI6ImFwcGxpY2F0aW9uL2lkZW4zLXprcC1qc29uIn0';
  static String payloadBase64 =
      'eyJpZCI6IjI4NDk0MDA3LTljNDktNGYxYS05Njk0LTc3MDBjMDg4NjViZiIsInR5cCI6ImFwcGxpY2F0aW9uL2lkZW4zY29tbS1wbGFpbi1qc29uIiwidHlwZSI6Imh0dHBzOi8vaWRlbjMtY29tbXVuaWNhdGlvbi5pby9hdXRob3JpemF0aW9uLzEuMC9yZXNwb25zZSIsInRoaWQiOiI3ZjM4YTE5My0wOTE4LTRhNDgtOWZhYy0zNmFkZmRiOGI1NDIiLCJib2R5Ijp7Im1lc3NhZ2UiOiJtZXNzYWdlIHRvIHNpZ24iLCJzY29wZSI6W3siaWQiOjEsImNpcmN1aXRfaWQiOiJjcmVkZW50aWFsQXRvbWljUXVlcnlNVFAiLCJwcm9vZiI6eyJwaV9hIjpbIjIwOTczNDg1MTA3MTg2NjEzODM1Mjk0NDIwNTA0MTY4ODQ0OTAwMDYwNDI5NzQ1MTgwMjc3MzcwMDc4MTM2NjQ1NDIzMzIzNzk2OTg4IiwiMjA4NzY1MTIzNTU1MTc0NTQzNTgzODczNTIzNTc0MzA0NjkyNjk1MzI1MTEyMDg0Mjc3MDI0MzU2NDA5NTQyMTI0MTQ4NDY3OTQ5ODgiLCIxIl0sInBpX2IiOltbIjE1MzU5Nzg3NzkyMjkxMzAxNTI0NDI5NTExNTYzMTYzODE5ODMzMjA5NjcwNTg2ODkxNDk5MTQ5ODgwMTAzODk3ODIxNjMxODEyMzIwIiwiOTUyMTQ4MDk3NzQxMzE4NzUwNDAxNDA2Njc4MjQ4ODY0NDgyNDA4MTEzNDE4NzI4MDQ1NTQxODUzMjU0ODM4NzkwMjExOTQ0NTU3Il0sWyIzODY2NTQ3MDY4OTg4Mzc4NDE5Nzg3MjE2NDk0ODUwNDQxOTM3MzkzNzQ4ODQ5ODU5NDExNjE5OTk1MDMwMDkxNjY2Njc4MjM0MjMzIiwiMTI3MzcyNjA5NTQ5ODM3NzIwNDc2ODA0Mzc5NDExOTM2NzU4ODYyMTUzMTU0NjM5NjUwOTk1MjcyMTUzNTQ0Mjg4NTYxNjY1ODkyMjAiXSxbIjEiLCIwIl1dLCJwaV9jIjpbIjE0MDMyMDUxNjY5Mzc2NTE5OTMyOTU3MDcyMTQ3MzgyNzM5MTM0NjU4ODg1NzgyNjYxMzkwMTcwNjU4NjMxMTA3Nzk1Mzg2MDM0OTkwIiwiMzQyNjY1MTkyMDE2ODU3NjE0MTMyODQ2NjQ0MTM4NTg3Mjg5NDgyNDQxNzE0MTc4ODI2MDgzMDgzMjU2MzcwNzk1MDYwNTAzNDU0MiIsIjEiXSwicHJvdG9jb2wiOiJncm90aDE2In0sInB1Yl9zaWduYWxzIjpbIjIyNzk5OTc5MjU2MDYwMTU4MTE0MzkyMzEyMTIxMDM4ODM4MjE5ODI3NjgyODkzMjExMjIzNzc0MjMxOTE1MzcwOTI3NDIzNDg4MCIsIjEwMDk5Nzg5NjY1MzAwOTc1NDU3ODAyMTc4ODYyMjk2MDk4MjcxMjQzMzU5NjYwMzE1ODAyNzU5NDk1MDE2Mjg1MzUyNjQwMjEyODE0IiwiMTIzNDUiLCI4MzkwNzk1NjU0NzM5MjAzOTcyNjE2OTI2Nzc0MDkxNDQ1NDk4NDUxNTIwODEzMTQyMTIxMzY1Njc4NTY1MTM2MjI4NTI4NzI1MzEyIiwiMjA2ODExNzkxNDMxMjY5NzA3NDI3NTg5MzAyMjc0OTUyNDczMTQ3ODc5ODg4MDIyMTQyMDk2MzYzOTUwNDY1NjU2MDE0MTEwNzIwIiwiMTY1MzA1NzA2MiIsIjEwNjU5MDg4MDA3MzMwMzQxODgxODQ5MDcxMDYzOTU1NjcwNDQ2MiIsIjIiLCI0IiwiODQwIiwiMTIwIiwiMzQwIiwiNTA5IiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIiwiMCIsIjAiLCIwIl19XX0sImZyb20iOiIxMTl0cWNlV2RSZDJGNlduQXlWdUZRUkZqSzNXVVhxMkxvclNQeUc5TEoiLCJ0byI6IjExMjVHSnFndzZZRXNLRndqNjNHWTg3TU14UEw5a3dES3hQVWl3TUxOWiJ9';
  static String proofBase64 =
      'eyJwcm9vZiI6eyJwaV9hIjpbIjEwNDEyNDM2MTk3NDk0NDc5NTg3Mzk2NjY3Mzg1NzA3MzY4MjgyNTY4MDU1MTE4MjY5ODY0NDU3OTI3NDc2OTkwNjM2NDE5NzAyNDUxIiwiMTA3ODE3MzkwOTU0NDUyMDE5OTY0Njc0MTQ4MTc5NDE4MDU4Nzk5ODI0MTA2NzYzODYxNzY4NDUyOTYzNzYzNDQ5ODUxODc2NjMzMzQiLCIxIl0sInBpX2IiOltbIjE4MDY3ODY4NzQwMDA2MjI1NjE1NDQ3MTk0NDcxMzcwNjU4OTgwOTk5OTI2MzY5Njk1MjkzMTE1NzEyOTUxMzY2NzA3NzQ0MDY0NjA2IiwiMjE1OTkyNDE1NzA1NDc3MzEyMzQzMDQwMzk5ODkxNjY0MDY0MTU4OTk3MTc2NTkxNzE3NjAwNDM4OTk1MDkxNTIwMTE0Nzk2NjM3NTciXSxbIjY2OTk1NDA3MDUwNzQ5MjQ5OTc5NjcyNzUxODYzMjQ3NTU0NDIyNjA2MDc2NzE1MzY0MzQ0MDMwNjU1MjkxNjQ3Njk3MDI0NzczOTgiLCIxMTI1NzY0MzI5MzIwMTYyNzQ1MDI5MzE4NTE2NDI4ODQ4MjQyMDU1OTgwNjY0OTkzNzM3MTU2ODE2MDc0MjYwMTM4NjY3MTY1OTgwMCJdLFsiMSIsIjAiXV0sInBpX2MiOlsiNjIxNjQyMzUwMzI4OTQ5NjI5Mjk0NDA1MjAzMjE5MDM1MzYyNTQyMjQxMTQ4MzM4MzM3ODk3OTAyOTY2NzI0Mzc4NTMxOTIwODA5NSIsIjE0ODE2MjE4MDQ1MTU4Mzg4NzU4NTY3NjA4NjA1NTc2Mzg0OTk0MzM5NzE0MzkwMzcwMzAwOTYzNTgwNjU4Mzg2NTM0MTU4NjAzNzExIiwiMSJdLCJwcm90b2NvbCI6Imdyb3RoMTYifSwicHViX3NpZ25hbHMiOlsiNDk3Njk0Mzk0Mzk2NjM2NTA2MjEyMzIyMTk5OTgzODAxMzE3MTIyODE1NjQ5NTM2NjI3MDM3NzI2MTM4MDQ0OTc4Nzg3MTg5ODY3MiIsIjE4NjU2MTQ3NTQ2NjY2OTQ0NDg0NDUzODk5MjQxOTE2NDY5NTQ0MDkwMjU4ODEwMTkyODAzOTQ5NTIyNzk0NDkwNDkzMjcxMDA1MzEzIiwiMzc5OTQ5MTUwMTMwMjE0NzIzNDIwNTg5NjEwOTExMTYxODk1NDk1NjQ3Nzg5MDA2NjQ5Nzg1MjY0NzM4MTQxMjk5MTM1NDE0MjcyIl19';

  static String jwzBase64 = "$headerBase64.$payloadBase64.$proofBase64";

  static JWZHeader jwzHeader = JWZHeader(
      alg: "groth16",
      circuitId: "auth",
      crit: const ["circuitId"],
      typ: "application/iden3-zkp-json");

  static JWZProof jwzProof = JWZProof(
      proof: JWZBaseProof(piA: const [
        "10412436197494479587396667385707368282568055118269864457927476990636419702451",
        "10781739095445201996467414817941805879982410676386176845296376344985187663334",
        "1"
      ], piB: const [
        [
          "18067868740006225615447194471370658980999926369695293115712951366707744064606",
          "21599241570547731234304039989166406415899717659171760043899509152011479663757"
        ],
        [
          "6699540705074924997967275186324755442260607671536434403065529164769702477398",
          "11257643293201627450293185164288482420559806649937371568160742601386671659800"
        ],
        ["1", "0"]
      ], piC: const [
        "6216423503289496292944052032190353625422411483383378979029667243785319208095",
        "14816218045158388758567608605576384994339714390370300963580658386534158603711",
        "1"
      ], protocol: "groth16"),
      pubSignals: const [
        "4976943943966365062123221999838013171228156495366270377261380449787871898672",
        "18656147546666944484453899241916469544090258810192803949522794490493271005313",
        "379949150130214723420589610911161895495647789006649785264738141299135414272"
      ]);

  static String inputPreparerData =
      '{"userAuthClaim":["304427537360709784173770334266246861770","0","17640206035128972995519606214765283372613874593503528180869261482403155458945","20634138280259599560273310290025659992320584624461316485434108770067472477956","15930428023331155902","0","0","0"],"userAuthClaimMtp":["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],"userAuthClaimNonRevMtp":["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],"userAuthClaimNonRevMtpAuxHi":"0","userAuthClaimNonRevMtpAuxHv":"0","userAuthClaimNonRevMtpNoAux":"1","challenge":"6568187306293073175114267504711682812904598368490904573742495126063294481938","challengeSignatureR8x":"15230565441506590379169832995887068998322005265009046474267743823535028195613","challengeSignatureR8y":"10769958837943955028152112183244447895061604149794975067459918696631541903296","challengeSignatureS":"421650140447062113811542806382702329042840096310563827636625110300562791229","userClaimsTreeRoot":"9763429684850732628215303952870004997159843236039795272605841029866455670219","userID":"379949150130214723420589610911161895495647789006649785264738141299135414272","userRevTreeRoot":"0","userRootsTreeRoot":"0","userState":"18656147546666944484453899241916469544090258810192803949522794490493271005313"}';

  static Uint8List inputPreparer =
      Uint8ArrayUtils.uint8ListfromString(inputPreparerData);

  static JWZ jwz = JWZ(header: jwzHeader, payload: jwzPayload, proof: jwzProof);

  static CircomLib fakeCircom = FakeCircom();
}

class FakeCircom extends Fake implements CircomLib {
  @override
  String poseidonHash(String input) {
    return '3DFF';
  }
}
